{"version":3,"sources":["utils/xhrHttp.ts","config/index.ts","screens/ApplyActivity/index.tsx","services/index.ts","screens/ApplyActivity/services.ts","router/index.tsx","App.tsx","index.tsx"],"names":["requestXhrHttp","axios","create","baseURL","timeout","headers","Authorization","localStorage","getItem","interceptors","request","use","config","error","Promise","reject","response","data","ApplyActivity","useState","fileList","setFileList","datePickerVis","setDatePickerVis","signWayVis","setSignWayVis","rankNameVis","setRankNameVis","rankIdVis","setRankIdVis","fileBol","useRef","file","a","current","url","URL","createObjectURL","type","name","useEffect","Form","useForm","from","selectItem","form","onFinish","values","formData","FormData","append","method","then","res","uri","console","log","createActivity","grade","Number","parseFloat","canNumber","parseInt","imgUrl","rankId","undefined","catch","Toast","show","icon","content","footer","block","color","size","onClick","Item","label","placeholder","value","onChange","upload","maxCount","onDelete","Dialog","confirm","maxLength","rows","showCount","readOnly","getFieldValue","visible","onClose","precision","onConfirm","val","setFieldsValue","Dayjs","format","columns","v","signWay","rankName","ReactRouter","path","element","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.736e7d55.chunk.js","sourcesContent":["import axios from 'axios';\r\nimport { BASE_URI } from '../config/index';\r\n\r\nconst requestXhrHttp = axios.create({\r\n  baseURL: BASE_URI,\r\n  timeout: 7000,\r\n  headers: {\r\n    'Content-Type': 'application/json;charset=UTF-8',\r\n    Authorization: localStorage.getItem('token') || '',\r\n  },\r\n});\r\n\r\n// 添加请求拦截器\r\nrequestXhrHttp.interceptors.request.use(\r\n  (config) => {\r\n    return config;\r\n  },\r\n  function (error) {\r\n    // 对请求错误做些什么\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// 添加响应拦截器\r\nrequestXhrHttp.interceptors.response.use(\r\n  function (response) {\r\n    // 对响应数据做点什么\r\n    return response.data;\r\n  },\r\n  function (error) {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default requestXhrHttp;\r\n","export const BASE_URI = 'http://192.168.43.53:8686/';\r\nexport const AVATAR_URI = 'http://192.168.0.107:4000/';","import React, { useEffect, useRef, useState } from 'react';\r\nimport { ImageUploader, Space, Toast, Dialog, Button, Form, Input, TextArea, Picker, DatePicker } from 'antd-mobile';\r\nimport { ImageUploadItem } from 'antd-mobile/es/components/image-uploader';\r\nimport Dayjs from 'dayjs';\r\nimport { uploadSingleFile } from '../../services';\r\nimport { createActivity } from './services';\r\nexport type ActivityType = {\r\n  title: string; // 活动标题\r\n  introduce: string; // 活动介绍\r\n  grade: string; // 活动分数\r\n  startTime: string; // 活动开始时间\r\n  endTime: string; // 活动结束时间\r\n  location: string; // 活动地点\r\n  organization: string; // 活动组织\r\n  initiator: string; // 活动发起人姓名\r\n  rankName: string; // 活动级别\r\n  rankId: string; // 分院编号或者是班级编号\r\n  canNumber: string; // 可以参与人数\r\n  signWay: string; // 活动签到方式\r\n  stStatus: string; // 活动状态\r\n};\r\nexport default function ApplyActivity() {\r\n  const [fileList, setFileList] = useState<ImageUploadItem[]>([]);\r\n  const [datePickerVis, setDatePickerVis] = useState(false);\r\n  const [signWayVis, setSignWayVis] = useState(false);\r\n  const [rankNameVis, setRankNameVis] = useState(false);\r\n  const [rankIdVis, setRankIdVis] = useState(false);\r\n\r\n  const fileBol = useRef<File>();\r\n  async function mockUpload(file: File) {\r\n    fileBol.current = file;\r\n    return {\r\n      url: URL.createObjectURL(file),\r\n      type: file.type,\r\n      name: file.name,\r\n    };\r\n  }\r\n  useEffect(() => {}, []);\r\n  const [from] = Form.useForm();\r\n  const selectItem = useRef('');\r\n  function onFinish(values: ActivityType) {\r\n    if (fileBol.current) {\r\n      let formData = new FormData();\r\n      formData.append('file', fileBol.current);\r\n      formData.append('fileType', 'sutuo');\r\n      uploadSingleFile(formData)\r\n        .then((res) => {\r\n          const uri = res.data.uri;\r\n          console.log('res', uri);\r\n          const sendData = {\r\n            ...values,\r\n            grade: values.grade ? Number.parseFloat(values.grade) : 0.0,\r\n            canNumber: values.canNumber ? Number.parseInt(values.canNumber) : 0,\r\n            imgUrl: uri,\r\n            rankId: values.canNumber ? Number.parseInt(values.canNumber) : undefined,\r\n          };\r\n          createActivity(sendData).then((res) => {\r\n            console.log(res);\r\n          });\r\n        })\r\n        .catch(() => {\r\n          Toast.show({\r\n            icon: 'fail',\r\n            content: '申请活动失败',\r\n          });\r\n        });\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Form\r\n        name=\"form\"\r\n        form={from}\r\n        onFinish={onFinish}\r\n        footer={\r\n          <Button\r\n            block\r\n            type=\"submit\"\r\n            color=\"primary\"\r\n            size=\"large\"\r\n            onClick={() => {\r\n              console.log('sad', fileList);\r\n            }}\r\n          >\r\n            提交\r\n          </Button>\r\n        }\r\n      >\r\n        <Form.Item name=\"title\" label=\"标题\">\r\n          <Input placeholder=\"请输入活动标题\" />\r\n        </Form.Item>\r\n        <Form.Item name=\"imgUrl\" label=\"活动图片\">\r\n          <ImageUploader\r\n            value={fileList}\r\n            onChange={setFileList}\r\n            upload={mockUpload}\r\n            maxCount={1}\r\n            onDelete={() => {\r\n              return Dialog.confirm({\r\n                content: '是否确认删除',\r\n              });\r\n            }}\r\n          />\r\n        </Form.Item>\r\n        <Form.Item name=\"introduce\" label=\"活动内容\">\r\n          <TextArea placeholder=\"请输入\" maxLength={250} rows={2} showCount />\r\n        </Form.Item>\r\n        <Form.Item name=\"grade\" label=\"活动分数\">\r\n          <Input placeholder=\"请输入\" type=\"number\" />\r\n        </Form.Item>\r\n        <Form.Item\r\n          name=\"startTime\"\r\n          label=\"开始时间\"\r\n          onClick={async () => {\r\n            setDatePickerVis(true);\r\n            selectItem.current = 'startTime';\r\n          }}\r\n        >\r\n          <Input readOnly placeholder=\"请选择开始时间\" />\r\n        </Form.Item>\r\n        <Form.Item\r\n          name=\"endTime\"\r\n          label=\"结束时间\"\r\n          onClick={async () => {\r\n            setDatePickerVis(true);\r\n            selectItem.current = 'endTime';\r\n          }}\r\n        >\r\n          <Input readOnly placeholder=\"请选择结束时间\" />\r\n        </Form.Item>\r\n        <Form.Item name=\"location\" label=\"活动地点\">\r\n          <Input placeholder=\"请输入\" />\r\n        </Form.Item>\r\n        <Form.Item name=\"organization\" label=\"活动组织\">\r\n          <Input placeholder=\"请输入\" />\r\n        </Form.Item>\r\n        <Form.Item name=\"initiator\" label=\"活动发起人姓名\">\r\n          <Input placeholder=\"请输入\" />\r\n        </Form.Item>\r\n        <Form.Item\r\n          name=\"rankName\"\r\n          label=\"活动级别\"\r\n          onClick={async () => {\r\n            setRankNameVis(true);\r\n          }}\r\n        >\r\n          <Input placeholder=\"请选择\" readOnly />\r\n        </Form.Item>\r\n        <Form.Item\r\n          name=\"rankId\"\r\n          label=\"活动对象\"\r\n          onClick={async () => {\r\n            if (from.getFieldValue('rankName') === '院级') return;\r\n            setRankIdVis(true);\r\n          }}\r\n        >\r\n          <Input placeholder=\"请输入\" readOnly />\r\n        </Form.Item>\r\n        <Form.Item name=\"canNumber\" label=\"可以参与人数\">\r\n          <Input placeholder=\"请输入\" type=\"number\" />\r\n        </Form.Item>\r\n        <Form.Item\r\n          name=\"signWay\"\r\n          label=\"活动签到方式\"\r\n          onClick={async () => {\r\n            setSignWayVis(true);\r\n          }}\r\n        >\r\n          <Input placeholder=\"请选择\" readOnly />\r\n        </Form.Item>\r\n      </Form>\r\n      <DatePicker\r\n        visible={datePickerVis}\r\n        onClose={() => {\r\n          setDatePickerVis(false);\r\n        }}\r\n        precision=\"minute\"\r\n        onConfirm={(val) => from.setFieldsValue({ [selectItem.current]: Dayjs(val).format('YYYY-MM-DD HH:mm:ss') })}\r\n      />\r\n      <Picker\r\n        columns={[[{ label: '定位签到', value: '定位签到' }]]}\r\n        visible={signWayVis}\r\n        onClose={() => {\r\n          setSignWayVis(false);\r\n        }}\r\n        onConfirm={(v) => {\r\n          from.setFieldsValue({\r\n            signWay: v[0],\r\n          });\r\n        }}\r\n      />\r\n      <Picker\r\n        columns={[\r\n          [\r\n            { label: '院级', value: '院级' },\r\n            { label: '班级', value: '班级' },\r\n          ],\r\n        ]}\r\n        visible={rankNameVis}\r\n        onClose={() => {\r\n          setRankNameVis(false);\r\n        }}\r\n        onConfirm={(v) => {\r\n          if (v[0] === '院级') {\r\n            from.setFieldsValue({\r\n              rankId: '分院全体成员',\r\n            });\r\n          }\r\n          if (v[0] === '班级') {\r\n            from.setFieldsValue({\r\n              rankId: undefined,\r\n            });\r\n          }\r\n          from.setFieldsValue({\r\n            rankName: v[0],\r\n          });\r\n        }}\r\n      />\r\n      <Picker\r\n        columns={[\r\n          [\r\n            { label: '院级', value: '院级' },\r\n            { label: '班级', value: '班级' },\r\n          ],\r\n        ]}\r\n        visible={rankNameVis}\r\n        onClose={() => {\r\n          setRankNameVis(false);\r\n        }}\r\n        onConfirm={(v) => {\r\n          if (v[0] === '院级') {\r\n            from.setFieldsValue({\r\n              rankId: '分院全体成员',\r\n            });\r\n          }\r\n          if (v[0] === '班级') {\r\n            from.setFieldsValue({\r\n              rankId: undefined,\r\n            });\r\n          }\r\n          from.setFieldsValue({\r\n            rankName: v[0],\r\n          });\r\n        }}\r\n      />\r\n      <Picker\r\n        columns={[\r\n          [\r\n            { label: '院级', value: '院级' },\r\n            { label: '班级', value: '班级' },\r\n          ],\r\n        ]}\r\n        visible={rankIdVis}\r\n        onClose={() => {\r\n          setRankIdVis(false);\r\n        }}\r\n        onConfirm={(v) => {\r\n          from.setFieldsValue({\r\n            rankId: v[0],\r\n          });\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","import { AxiosPromise } from 'axios';\r\nimport requestXhrHttp from '../utils/xhrHttp';\r\n\r\n// axios.post('http://192.168.0.107:8686/upload/uploadSingleFile', formData, {\r\n//   headers: {\r\n//\r\n//     Authorization: `Bearer ${window.localStorage.getItem('token') ?? ''}`,\r\n//   },\r\n// });\r\nexport function uploadSingleFile(data: FormData): AxiosPromise<{ uri: string }> {\r\n  return requestXhrHttp({\r\n    url: 'upload/uploadSingleFile',\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'multipart/form-data',\r\n    },\r\n    data,\r\n  });\r\n}\r\n","import { AxiosPromise } from 'axios';\r\nimport requestXhrHttp from '../../utils/xhrHttp';\r\n\r\nexport function createActivity(data: any): AxiosPromise<{ uri: string }> {\r\n  return requestXhrHttp({\r\n    url: 'sutuo/createActivity',\r\n    method: 'POST',\r\n    data,\r\n  });\r\n}\r\n","import { HashRouter, Routes, Route } from 'react-router-dom';\r\nimport ApplyActivity from '../screens/ApplyActivity/index';\r\nexport default function ReactRouter() {\r\n  return (\r\n    <HashRouter>\r\n      <Routes>\r\n        <Route path=\"/applyActivity\" element={<ApplyActivity />} />\r\n      </Routes>\r\n    </HashRouter>\r\n  );\r\n}\r\n","import './App.less';\nimport ReactRouter from './router';\n\nexport default function App() {\n  return (\n    <>\n      <ReactRouter />\n    </>\n  );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport 'reset-css';\nimport 'lib-flexible';\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}